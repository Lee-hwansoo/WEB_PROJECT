# 2í•™ê¸° ë°©í•™ í”„ë¡œì íŠ¸ (2020.01 ~ 2020.02)

ë¯¸í‹°ì–´ë¥¼ ì´ìš©í•´ ì›¹ì‚¬ì´íŠ¸ ìƒì„± í”„ë¡œì íŠ¸

## ì£¼ì œ

meteorë¥¼ í†µí•´ ì›¹ì‚¬ì´íŠ¸ì˜ ê¸°ëŠ¥ì„ ê³µë¶€í•¨ê³¼ ê°œì¸ì˜ ì‚¬ì´íŠ¸ë¥¼ êµ¬í˜„

## ê¸°íšë°°ê²½

ê°œì¸ë³„ ë°ì´í„°ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ ê°œì¸ì˜ ì •ë³´ì¸ ì¼ê¸°ë‚˜ ì¼ì •ì„ ê´€ë¦¬í•˜ëŠ” ì›¹ì‚¬ì´íŠ¸ë¥¼ ê¸°íš

## íŒ€ì›

[ë°•ì±„í¬](https://github.com/ChaeheePark)  
êµ¬ëŒ€í™  
[ì´í™˜ìˆ˜](https://github.com/Lee-hwansoo)

## ì‚¬ìš©í”„ë¡œê·¸ë¨

**vscode** : ì½”ë“œ ì—ë””í„°

**mongoDB** : ë¡œì»¬í˜¸ìŠ¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬

## ê¸°ëŠ¥

**login** : ê°œì¸ë³„ ì‚¬ì´íŠ¸ êµ¬í˜„

**data input/output** : mongodbë¥¼ í†µí•´ ì›¹ì‚¬ì´íŠ¸ êµ¬í˜„

**file input** : ë‹¹ì¼ì˜ ê¸°ë¶„ì„ í‘œí˜„í•˜ëŠ” ë…¸ë˜ ì¶œë ¥

## ì›¹ ì‚¬ì´íŠ¸ ëª¨ìŠµ

![ë©”ì¸ í˜ì´ì§€](https://user-images.githubusercontent.com/60167644/127848064-903b429c-dea5-406b-9473-dde34d59cc6a.png)

![íšŒì›ê°€ì…](https://user-images.githubusercontent.com/60167644/127848172-bcfa36de-7b5f-4a48-b96f-d21799ccea90.png)

![ë¡œê·¸ì¸ ëœ í˜ì´ì§€(ì¼ì • í˜ì´ì§€)](https://user-images.githubusercontent.com/60167644/127848188-6b19ffd2-e198-466d-86af-1244eff8fef2.png)

![ex)ì¼ì •ì‘ì„±](https://user-images.githubusercontent.com/60167644/127848202-8a254d6f-5fb4-46ed-a61e-8e73372cc2f8.png)

![ex)ì¼ì • ì‘ì„±í›„ ëª¨ìŠµ](https://user-images.githubusercontent.com/60167644/127848219-b14c16a0-a4e3-41ad-9df4-15c8235eb505.png)

![ì¼ê¸° ë©”ì¸í˜ì´ì§€](https://user-images.githubusercontent.com/60167644/127848227-e5af2379-9d0d-4b61-afea-d56f1f2957b3.png)

![ì¼ê¸° ì‘ì„±](https://user-images.githubusercontent.com/60167644/127848240-14639ddf-b4ad-472d-a163-04b100a6c3e3.png)

![ê°€ê³„ë¶€ ì‘ì„±1](https://user-images.githubusercontent.com/60167644/127848256-1e0aeb23-3639-4bd3-8b91-a6b1c4a3fa65.png)

![ê°€ê³„ë¶€ ì‘ì„±2](https://user-images.githubusercontent.com/60167644/127848267-21ec2d1b-f148-4c35-b90c-0ec497e88aab.png)

![ì¼ê¸° ë¯¸ë¦¬ë³´ê¸°](https://user-images.githubusercontent.com/60167644/127848276-e5110b71-7ed6-44eb-a613-2dd14966d9bf.png)

![ì¼ê¸°ìƒì„¸ë³´ê¸°](https://user-images.githubusercontent.com/60167644/127848288-57118c84-a724-4fbe-9abd-5854ea805611.png)

## í´ë¼ì´ì–¸íŠ¸ êµ¬ì¡°

1. ë©”ì¸ í˜ì´ì§€

2. íšŒì›ê°€ì… (users ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€)

3. ë¡œê·¸ì¸ ëœ í˜ì´ì§€(ì¼ì •í˜ì´ì§€)

4. ì¼ì • ì‘ì„±(í• ê²ƒ) (ì¼ì • ì‘ì„± í˜ì´ì§€) â†’ ì¼ì • í™•ì¸ í˜ì´ì§€

5. ì¼ê¸°ì¥ ì‘ì„±(í•œê²ƒ) (ì¼ê¸° í˜ì´ì§€)

    1. ì¼ê¸° ì‘ì„±í˜ì´ì§€

    2. ê°€ê³„ë¶€ ì‘ì„±í˜ì´ì§€

    3. ì¼ê¸° í™•ì¸ í˜ì´ì§€

## ë°ì´í„° ë² ì´ìŠ¤ êµ¬ì¡°

ì¼ì •

db_memo : user_id, date, text, createdAt

ì¼ê¸°ì¥

db_diary : user_id, date, diary(Object), money(Array)  
diary(Object) : title, file_id, text, createdAt  
money(Array) : time, money, option, text

## ì¼ì • ì‘ì„± êµ¬ì¡°

ğŸ“memo_writing.js

```js
FlowRouter.template('/memo_writing/:_id','memo_writing');

Template.memo_writing.onRendered(function () {
    $('#editor').summernote({
        toolbar: [
            ['Font Style',['fontsize','color']],
            ['Paragraph style',['ul']]
        ],
        lang: 'ko-KR',
        minHeight: 110,
        maximumImageFileSize: 1048576*10
    });
    $('#editor').summernote('insertUnorderedList');
});

Template.memo_writing.onDestroyed(function () {

});

Template.memo_writing.helpers({
    memo: function () {
        var _id = FlowRouter.getParam('_id');
        if(_id === 'newPosting') {
            return {};    //ìƒˆê¸€ ì‘ì„±ì¼ë•ŒëŠ” í™”ë©´ì— ë¹„ì–´ìˆëŠ” ë°ì´í„°ë¥¼ ì œê³µ.
        }

       Meteor.setTimeout(function() { //í™”ë©´ ì—ë””í„°ì— í¸ì§‘ ëª¨ë“œë¥¼ ì´ˆê¸°í™” í•˜ê¸° ìœ„í•œ íŠ¸ë¦­
            $('#editor').summernote('reset')
        });

        return DB_MEMO.findOne({_id:_id});
    }
})


Template.memo_writing.events({
    'click #btn-head-write': function () {
        var user_id =  Meteor.user()._id;
        var date = $('#inp-day').val();
        var text = $('#editor').summernote('code');
        if (!date) {
            return alert('ë‚ ì§œë¥¼ ë°˜ë“œì‹œ ì…ë ¥ í•´ ì£¼ì„¸ìš”.');
        }
        var _id = FlowRouter.getParam('_id');
        if( _id === 'newPosting') {
            var date_option = DB_MEMO.findOne({user_id: user_id,date:date});
            if(date_option)
            {
                return alert('ê°™ì€ ë‚ ì§œë¡œëœ ì¼ì •ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');
            }
            DB_MEMO.insert({
                user_id: user_id,
                date: date,
                text: text,
                createdAt: new Date(),
            })
        } else {
            var memo = DB_MEMO.findOne({_id:_id});
            if(memo.date != date)
            {
                alert('ìˆ˜ì • ë¶ˆê°€ëŠ¥í•œ ë‚ ì§œì˜ ë©”ëª¨ì…ë‹ˆë‹¤.');
                date = memo.date;
                memo.text = text;
                DB_MEMO.update({_id:_id}, memo);
                return history.go(0);
            }
            memo.date = date;
            memo.text = text;
            memo.createdAt = new Date();
            DB_MEMO.update({_id:_id}, memo);
        }

        alert('ì¼ì •ì„ ì €ì¥í•˜ì˜€ìŠµë‹ˆë‹¤.');
        $('#inp-day').val('');
        $('#editor').summernote('reset');
        FlowRouter.go('/memo');
    }
})
```

1. key = user_idë¡œ ê°œì¸ë³„ ë°ì´í„° êµ¬ì„±

2. ì£¼ì†Œì˜ \_idê°€ newPosting ì´ë©´ ìƒˆ ì¼ì • ì‘ì„±

   1. ë³€ìˆ˜ date_optionë¡œ ê°™ì€ ë‚ ì§œì˜ ì¼ì •ì´ ì¡´ì¬í•˜ë©´ ì‘ì„± ì•ˆë¨

3. ì£¼ì†Œì˜ \_idê°€ ì´ë¯¸ ì‘ì„±ëœ ì¼ì •ì˜ \_id ì´ë©´ í•´ë‹¹ ì¼ì • ìˆ˜ì •

   1. ìˆ˜ì • í•˜ê³ ì í•˜ëŠ” ì¼ì •ê³¼ ê°™ì€ ë‚ ì§œì˜ ì¼ì •ë§Œ ìˆ˜ì • ê°€ëŠ¥

## ì¼ê¸° ì‘ì„± êµ¬ì¡°

ğŸ“diary_writing.js

```js
FlowRouter.template('/diary_writing/:_id','diary_writing');

Template.diary_writing.onRendered(function () {
    $('#editor').summernote({
        toolbar: [
            ['Font Style',['fontsize','color']],
            ['insert',['picture','link','video']]
        ],
        lang: 'ko-KR',
        minHeight: 110,
        maximumImageFileSize: 1048576*10
    });
});

Template.diary_writing.onDestroyed(function () {

});


Template.diary_writing.helpers({
    diarys: function () {
        var _id = FlowRouter.getParam('_id');
        if(_id === 'newPosting') {
            return {};    //ìƒˆê¸€ ì‘ì„±ì¼ë•ŒëŠ” í™”ë©´ì— ë¹„ì–´ìˆëŠ” ë°ì´í„°ë¥¼ ì œê³µ.
        }
        Meteor.setTimeout(function() { //í™”ë©´ ì—ë””í„°ì— í¸ì§‘ ëª¨ë“œë¥¼ ì´ˆê¸°í™” í•˜ê¸° ìœ„í•œ íŠ¸ë¦­
            $('#editor').summernote('reset');
        });
        return DB_DIARY.findOne({_id:_id});
    },
    file: function() {
        return DB_FILES.findOne({_id: this.diary.file_id}).name;
    }
})

Template.diary_writing.events({
    'click #btn-diary-write':function () {
        var user_id = Meteor.user()._id;
        var date = $('#inp-day').val();
        var title = $('#inp-name').val();
        if(!$('#inp-music').prop('files')[0]){
            return alert('mp3íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.')
        }
        var file = $('#inp-music').prop('files')[0];
        var file_id = DB_FILES.insertFile(file);
        var text = $('#editor').summernote('code');
        if(!title){
            return alert('ì œëª©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.');
        }
        if(!date){
            return alert('ë‚ ì§œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.');
        }
        var _id = FlowRouter.getParam('_id');
        if( _id === 'newPosting'){
            var date_option = DB_DIARY.findOne({user_id: user_id,date:date});
            if(date_option)
            {
                return alert('ê°™ì€ ë‚ ì§œë¡œëœ ì¼ì •ì´ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤.');
            }
            DB_DIARY.insert({
                user_id: user_id,
                date: date,
                diary:{
                    title: title,
                    file_id: file_id,
                    text: text,
                    createdAt: new Date()
                }
            })
        }
        else{
            var diary = DB_DIARY.findOne({_id:_id});
            if(diary.date != date)
            {
                alert('ìˆ˜ì • ë¶ˆê°€ëŠ¥í•œ ë‚ ì§œì˜ ì¼ì •ì…ë‹ˆë‹¤.');
                date = diary.date;
                diary.diary.title = title;
                diary.diary.text = text;
                DB_DIARY.update({_id:_id}, diary);
                return history.go(0);
            }
            diary.diary.title= title;
            diary.diary.file_id = file_id;
            diary.diary.text = text
            diary.diary.createdAt = new Date();
            DB_DIARY.update({_id:_id}, diary);
        }
        alert('ì¼ê¸°ë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.');
        $('#inp-day').val('');
        $('#inp-music').val('');
        $('#editor').summernote('reset');
        FlowRouter.go('/diary');
    }
})
```

1. key = user_idë¡œ ê°œì¸ë³„ ë°ì´í„° êµ¬ì„±

2. ì£¼ì†Œì˜ \_idê°€ newPosting ì´ë©´ ìƒˆ ì¼ê¸° ì‘ì„±

   1. ë³€ìˆ˜ date_optionë¡œ ê°™ì€ ë‚ ì§œì˜ ì¼ê¸°ê°€ ì¡´ì¬í•˜ë©´ ì‘ì„± ì•ˆë¨

3. ì£¼ì†Œì˜ \_idê°€ ì´ë¯¸ ì‘ì„±ëœ ì¼ê¸°ì˜ \_id ì´ë©´ í•´ë‹¹ ì¼ê¸° ìˆ˜ì •

   1. ìˆ˜ì • í•˜ê³ ì í•˜ëŠ” ì¼ê¸°ì™€ ê°™ì€ ë‚ ì§œì˜ ì¼ê¸°ë§Œ ìˆ˜ì • ê°€ëŠ¥

## ê°€ê³„ë¶€ ì‘ì„± êµ¬ì¡°

ğŸ“money_writing.js

```js
FlowRouter.template('/money_writing','money_writing');

Template.money_writing.onRendered(function () {

});

Template.money_writing.onDestroyed(function () {

});

Template.money_writing.events({
    'click #btn-money-save':function() {
        var user_id = Meteor.user()._id;
        var date = $('#inp-day').val();
        var time = $('#inp-time').val();
        var money = $('#inp-money').val();
        var option = $('#select-money').val();
        var text = $('#inp-money-text').val();
        var date_option = DB_DIARY.findOne({user_id: user_id,date:date});
        if(date_option)
        {
            DB_DIARY.update({_id:date_option._id},{
                $push:{
                    money:{
                        time: time,
                        money: money,
                        option: option,
                        text: text,
                    }
                }
            })
        }
        else{
            DB_DIARY.insert({
                date: date,
                user_id: user_id,
                diary:{},
                money:[{
                    time: time,
                    money: money,
                    option: option,
                    text: text,
                }]
            });
        }
        alert('ê°€ê³„ë¶€ë¥¼ ì‘ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.');
        FlowRouter.go('/diary');
    }
})
```

1. key = user_idë¡œ ê°œì¸ë³„ ë°ì´í„° êµ¬ì„±

2. date_optionë³€ìˆ˜ë¡œ í•´ë‹¹ ë‚ ì§œì— ì¼ê¸°ê°€ ì¡´ì¬í•œë‹¤ë©´ ê°€ê³„ë¶€ ì—…ë°ì´íŠ¸

3. í•´ë‹¹ ë‚ ì§œì— ì¼ê¸°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ DB ìƒì„±í›„ ê°€ê³„ë¶€ ì„¤ì •

## ì•„ì‰¬ìš´ì 

ì¼ê¸° ì‘ì„±ì—ì„œ íŒŒì¼ ì €ì¥ êµ¬ì¡°  
ê°€ê³„ë¶€ì—ì„œ ê¸ˆì•¡ ìˆ˜ì •ì´ë‚˜ ì‚­ì œ ê¸°ëŠ¥ êµ¬í˜„í•˜ì§€ ëª»í•¨
